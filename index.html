<script>
  const tg = window.Telegram.WebApp;
  const status = document.getElementById("status");

  function send() {
    const initData = tg.initData;
    const initDataUnsafe = tg.initDataUnsafe;
    status.innerText = "initData: " + initData;

    try {
      const data = {
        test: "hello from WebApp",
        init: initData,
        user_id: initDataUnsafe?.user?.id || "неизвестно"
      };
      tg.sendData(JSON.stringify(data));
      status.innerText = "✅ Отправлено: " + JSON.stringify(data);
    } catch (e) {
      status.innerText = "Ошибка: " + e.message;
    }
  }

  tg.expand();
</script>
